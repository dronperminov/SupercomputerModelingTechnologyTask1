# SupercomputerModelingTechnologyTask1
Реализация первого практического задания в рамках курса "Суперкомпьютерное моделирование и технологии"

Реализована параллельная MPI-программа, принимающая от 0 до 9 аргументов (доступно при запуске с флагом --help):

* `-e` – необходимая точность вычисления интеграла (по умолчанию 1e-3);
* `-n` – количество точек, отдаваемых каждому процессу (по умолчанию 1000);
* `-d` – флаг отладки для вывода дополнительной информации (по умолчанию не используется);
* `-xmin` – нижняя граница изменения переменной x в параллелипипеде (по умолчанию 0);
* `-xmax` – верхняя граница изменения переменной x в параллелипипеде (по умолчанию 1);
* `-ymin` – нижняя граница изменения переменной y в параллелипипеде (по умолчанию 0);
* `-ymax` – верхняя граница изменения переменной y в параллелипипеде (по умолчанию 1);
* `-zmin` – нижняя граница изменения переменной z в параллелипипеде (по умолчанию 0);
* `-zmax` – верхняя граница изменения переменной z в параллелипипеде (по умолчанию 1);

При запуске программы все процессы считывают переданные аргументы, проверяя их на корректность, после чего в случае успешной проверки запускают основной цикл вычислений.
В качестве параллельной реализации используются две парадигмы: «мастер–рабочие» и обычная.


* Мастер-рабочии: один из процессов («мастер») генерирует случайные точки и передаёт каждому из остальных процессов («рабочих») отдельный, предназначенный для него, набор сгенерированных случайных точек. Все процессы – рабочие вычисляют свою часть суммы. Затем вычисляется общая сумма с помощью операции редукции и итоговый интеграл.

* Обычная: каждый процесс генерирует свои собственные точки независимо и затем считает общую сумму с помощью операции редукции. Итоговая сумма и интеграл аналогично парадигме «мастер–рабочие»

Полученное значение интеграла сравнивается с заранее заданным эталоном и в случае достижения требуемой точности процессам рабочим передаётся флаг, сигнализирующий об окончании вычислений и завершении работы. В противном случае генерируется новая порция точек и процесс вычисления повторяется.

## Сборка программы
Сборка осуществляется путём выполнения команды `make` из директории с программой. Для отправки на учебные кластеры используются цели `submit-polus` и `submit-bluegene`:

### Пример сборки:
```bash
> make
> make submit-polus
> make submit-bluegene
```

## Пример работы программы
```
Processors: 16
Eps: 1e-06
Points per process: 1000
Dimensions: [0, 1] x [0, 1] x [0, 1]
Volume: 1
Loops: 129
Total number of points: 2064000
Target integrate value: 0.00274725
Calculated integrate value: 0.0027475
Error: 2.48997e-07
Max time: 0.0163059
Min time: 0.0162583
Average time: 0.0162845
```

## Результаты расчётов на различных кластерах (N = 100)

### Bluegene (мастер-рабочий)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       1.0e-4 |                   2 |                   0.004468 |         1 | 5.32913e-5 |
|       1.0e-4 |                   4 |                   0.014046 |     0.318 | 5.89616e-5 |
|       1.0e-4 |                  16 |                   0.019665 |     0.227 | 7.10764e-5 |
|       1.0e-4 |                  64 |                   0.028244 |     0.158 | 5.22394e-5 |
|       2.0e-5 |                   2 |                   0.056957 |         1 | 1.03870e-5 |
|       2.0e-5 |                   4 |                   0.070161 |     0.812 | 1.15677e-5 |
|       2.0e-5 |                  16 |                   0.081684 |     0.697 | 1.16226e-5 |
|       2.0e-5 |                  64 |                   0.131924 |     0.432 | 1.05649e-5 |
|       8.0e-6 |                   2 |                   0.060621 |         1 | 4.35518e-6 |
|       8.0e-6 |                   4 |                   0.168929 |     0.359 | 4.95073e-6 |
|       8.0e-6 |                  16 |                   0.853789 |     0.071 | 5.33238e-6 |
|       8.0e-6 |                  64 |                   0.874426 |     0.069 | 4.50257e-6 |

### Polus (мастер-рабочий)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       3.0e-5 |                   2 |                   0.004153 |         1 | 1.66131e-5 |
|       3.0e-5 |                   4 |                   0.006460 |     0.643 | 1.78859e-5 |
|       3.0e-5 |                  16 |                   0.008121 |     0.511 | 1.61746e-5 |
|       3.0e-5 |                  64 |                   0.009108 |     0.456 | 1.68098e-5 |
|       5.0e-6 |                   2 |                   0.012281 |         1 | 2.72662e-6 |
|       5.0e-6 |                   4 |                   0.019870 |     0.618 | 2.86175e-6 |
|       5.0e-6 |                  16 |                   0.109038 |     0.113 | 3.09910e-6 |
|       5.0e-6 |                  64 |                   0.160492 |     0.077 | 3.33829e-6 |
|       1.5e-6 |                   2 |                   0.037681 |         1 | 8.72001e-7 |
|       1.5e-6 |                   4 |                   0.108473 |     0.347 | 9.59019e-7 |
|       1.5e-6 |                  16 |                   0.550174 |     0.068 | 8.12681e-7 |
|       1.5e-6 |                  64 |                   1.269200 |     0.030 | 9.51823e-7 |

### Bluegene (обычная схема)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |    Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |         :-: |
|       1.0e-4 |                   1 |                   0.008302 |         1 | 6.30016e-5 |
|       1.0e-4 |                   4 |                   0.003338 |     2.487 | 6.06925e-5 |
|       1.0e-4 |                  16 |                   0.001230 |     6.750 | 6.65863e-5 |
|       1.0e-4 |                  64 |                   0.000499 |    16.649 | 6.09067e-5 |
|       2.0e-5 |                   1 |                   0.068607 |         1 | 1.07895e-5 |
|       2.0e-5 |                   4 |                   0.019029 |     3.605 | 1.24707e-5 |
|       2.0e-5 |                  16 |                   0.005684 |    12.071 | 1.10576e-5 |
|       2.0e-5 |                  64 |                   0.005156 |    13.306 | 1.14240e-5 |
|       8.0e-6 |                   1 |                   0.266561 |         1 | 4.66384e-6 |
|       8.0e-6 |                   4 |                   0.196456 |     1.357 | 4.33287e-6 |
|       8.0e-6 |                  16 |                   0.018962 |    14.058 | 4.86004e-6 |
|       8.0e-6 |                  64 |                   0.022389 |    11.906 | 5.06120e-6 |

### Polus (обычная схема)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       3.0e-5 |                   1 |                   0.002213 |         1 | 1.77963e-5 |
|       3.0e-5 |                   4 |                   0.002644 |     0.837 | 1.74121e-5 |
|       3.0e-5 |                  16 |                   0.001644 |     1.346 | 1.90208e-5 |
|       3.0e-5 |                  64 |                   0.001900 |     1.165 | 1.85604e-5 |
|       5.0e-6 |                   1 |                   0.041500 |         1 | 2.74958e-6 |
|       5.0e-6 |                   4 |                   0.037462 |     1.108 | 2.85969e-6 |
|       5.0e-6 |                  16 |                   0.005661 |     7.330 | 3.27807e-6 |
|       5.0e-6 |                  64 |                   0.012620 |     3.288 | 2.91695e-6 |
|       1.5e-6 |                   1 |                   0.093396 |         1 | 9.05425e-7 |
|       1.5e-6 |                   4 |                   0.470570 |     0.198 | 8.01429e-7 |
|       1.5e-6 |                  16 |                   0.024551 |     3.804 | 9.07634e-7 |
|       1.5e-6 |                  64 |                   0.028883 |     3.234 | 9.51205e-7 |


## Результаты расчётов на различных кластерах (N = 1000)

### Bluegene (мастер-рабочий)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|         1e-4 |                   2 |                   0.033324 |         1 | 5.69829e-5 |
|         1e-4 |                   4 |                   0.029836 |     1.117 | 5.00716e-5 |
|         1e-4 |                  16 |                   0.051855 |     0.643 | 6.17547e-5 |
|         1e-4 |                  64 |                   0.082581 |     0.404 | 5.75076e-5 |
|         2e-5 |                   2 |                   0.137660 |         1 |  1.2201e-5 |
|         2e-5 |                   4 |                   0.524361 |     0.263 | 1.44155e-5 |
|         2e-5 |                  16 |                   0.167715 |     0.821 | 1.04416e-5 |
|         2e-5 |                  64 |                   0.329309 |     0.418 | 1.27367e-5 |
|         8e-6 |                   2 |                   0.130379 |         1 | 4.75472e-6 |
|         8e-6 |                   4 |                   1.850610 |     0.070 | 5.02529e-6 |
|         8e-6 |                  16 |                   0.375042 |     0.348 | 4.77424e-6 |
|         8e-6 |                  64 |                   2.159940 |     0.060 | 4.32039e-6 |


### Polus (мастер-рабочий)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       3.0e-5 |                   2 |                   0.015714 |         1 | 1.82846e-5 |
|       3.0e-5 |                   4 |                   0.010587 |     1.484 | 1.76684e-5 |
|       3.0e-5 |                  16 |                   0.016716 |     0.940 | 1.73457e-5 |
|       3.0e-5 |                  64 |                   0.026377 |     0.596 | 1.64332e-5 |
|       5.0e-6 |                   2 |                   0.051133 |         1 | 2.55487e-6 |
|       5.0e-6 |                   4 |                   0.175258 |     0.292 | 3.14434e-6 |
|       5.0e-6 |                  16 |                   0.153705 |     0.333 | 2.83515e-6 |
|       5.0e-6 |                  64 |                   0.333445 |     0.153 | 2.73644e-6 |
|       1.5e-6 |                   2 |                   0.096970 |         1 | 9.34065e-7 |
|       1.5e-6 |                   4 |                   0.684993 |     0.142 | 7.40848e-7 |
|       1.5e-6 |                  16 |                   1.453590 |     0.067 | 9.69010e-7 |
|       1.5e-6 |                  64 |                   1.491600 |     0.065 | 7.99376e-7 |

### Bluegene (обычная схема)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|         1e-4 |                   1 |                   0.013390 |         1 | 5.62939e-5 |
|         1e-4 |                   4 |                   0.006371 |     2.102 | 5.82478e-5 |
|         1e-4 |                  16 |                   0.002604 |     5.142 | 5.84753e-5 |
|         1e-4 |                  64 |                   0.001725 |     7.762 | 5.51759e-5 |
|         2e-5 |                   1 |                   0.117756 |         1 | 1.18561e-5 |
|         2e-5 |                   4 |                   0.048907 |     2.407 | 1.15702e-5 |
|         2e-5 |                  16 |                   0.011841 |     9.944 | 1.16796e-5 |
|         2e-5 |                  64 |                   0.009600 |    12.266 | 1.17729e-5 |
|         8e-6 |                   1 |                   0.354141 |         1 | 4.39475e-6 |
|         8e-6 |                   4 |                   0.446997 |     0.792 | 5.23333e-6 |
|         8e-6 |                  16 |                   0.054583 |     6.488 | 4.63279e-6 |
|         8e-6 |                  64 |                   0.036026 |     9.830 | 5.20942e-6 |


### Polus (обычная схема)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       3.0e-5 |                   1 |                   0.007158 |         1 | 1.83298e-5 |
|       3.0e-5 |                   4 |                   0.004834 |     1.481 | 1.94462e-5 |
|       3.0e-5 |                  16 |                   0.002981 |     2.401 | 1.61581e-5 |
|       3.0e-5 |                  64 |                   0.003191 |     2.243 | 1.81731e-5 |
|       5.0e-6 |                   1 |                   0.071685 |         1 | 2.53375e-6 |
|       5.0e-6 |                   4 |                   0.034224 |     2.095 | 2.57642e-6 |
|       5.0e-6 |                  16 |                   0.015392 |     4.657 | 2.84998e-6 |
|       5.0e-6 |                  64 |                   0.014488 |     4.948 | 3.15469e-6 |
|       1.5e-6 |                   1 |                   0.751209 |         1 | 7.92767e-7 |
|       1.5e-6 |                   4 |                   0.412068 |     1.823 | 7.19423e-7 |
|       1.5e-6 |                  16 |                   0.051451 |    14.600 | 9.54345e-7 |
|       1.5e-6 |                  64 |                   0.067100 |    11.195 | 9.14685e-7 |