# SupercomputerModelingTechnologyTask1
Реализация первого практического задания в рамках курса "Суперкомпьютерное моделирование и технологии"

Реализована параллельная MPI-программа, принимающая от 0 до 9 аргументов (доступно при запуске с флагом --help):

* `-e` – необходимая точность вычисления интеграла (по умолчанию 1e-3);
* `-n` – количество точек, отдаваемых каждому процессу (по умолчанию 1000);
* `-d` – флаг отладки для вывода дополнительной информации (по умолчанию не используется);
* `-o` – путь к файлу для вывода данных (по умолчанию output.txt);
* `-xmin` – нижняя граница изменения переменной x в параллелипипеде (по умолчанию 0);
* `-xmax` – верхняя граница изменения переменной x в параллелипипеде (по умолчанию 1);
* `-ymin` – нижняя граница изменения переменной y в параллелипипеде (по умолчанию 0);
* `-ymax` – верхняя граница изменения переменной y в параллелипипеде (по умолчанию 1);
* `-zmin` – нижняя граница изменения переменной z в параллелипипеде (по умолчанию 0);
* `-zmax` – верхняя граница изменения переменной z в параллелипипеде (по умолчанию 1);

При запуске программы все процессы считывают переданные аргументы, проверяя их на корректность, после чего в случае успешной проверки запускают основной цикл вычислений.
В качестве параллельной реализации используются две парадигмы: «мастер–рабочие» и обычная.


* Мастер-рабочии: один из процессов («мастер») генерирует случайные точки и передаёт каждому из остальных процессов («рабочих») отдельный, предназначенный для него, набор сгенерированных случайных точек. Все процессы – рабочие вычисляют свою часть суммы. Затем вычисляется общая сумма с помощью операции редукции и итоговый интеграл.

* Обычная: каждый процесс генерирует свои собственные точки независимо и затем считает общую сумму с помощью операции редукции. Итоговая сумма и интеграл аналогично парадигме «мастер–рабочие»

Полученное значение интеграла сравнивается с заранее заданным эталоном и в случае достижения требуемой точности процессам рабочим передаётся флаг, сигнализирующий об окончании вычислений и завершении работы. В противном случае генерируется новая порция точек и процесс вычисления повторяется.

## Сборка программы
Сборка осуществляется путём выполнения команды `make` из директории с программой. Для отправки на учебные кластеры используются цели `submit-polus` и `submit-bluegene`:

### Пример сборки:
```bash
> make
> make submit-polus
> make submit-bluegene
```

## Пример работы программы
```
Processors: 16
Eps: 1e-06
Points per process: 1000
Dimensions: [0, 1] x [0, 1] x [0, 1]
Volume: 1
Loops: 129
Total number of points: 2064000
Target integrate value: 0.00274725
Calculated integrate value: 0.0027475
Error: 2.48997e-07
Max time: 0.0163059
Min time: 0.0162583
Average time: 0.0162845
```

## Результаты расчётов на различных кластерах (N = 100)

### Bluegene (мастер-рабочий)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       1.0e-4 |                   2 |                   0.004501 |         1 | 5.32913e-5 |
|       1.0e-4 |                   4 |                   0.014000 |     0.322 | 5.89616e-5 |
|       1.0e-4 |                  16 |                   0.019937 |     0.226 | 7.10764e-5 |
|       1.0e-4 |                  64 |                   0.028256 |     0.159 | 5.22394e-5 |
|       2.0e-5 |                   2 |                   0.057212 |         1 | 1.03870e-5 |
|       2.0e-5 |                   4 |                   0.069890 |     0.819 | 1.15677e-5 |
|       2.0e-5 |                  16 |                   0.082842 |     0.691 | 1.16226e-5 |
|       2.0e-5 |                  64 |                   0.132092 |     0.433 | 1.05649e-5 |
|       8.0e-6 |                   2 |                   0.060874 |         1 | 4.35518e-6 |
|       8.0e-6 |                   4 |                   0.168358 |     0.362 | 4.95073e-6 |
|       8.0e-6 |                  16 |                   0.865558 |     0.070 | 5.33238e-6 |
|       8.0e-6 |                  64 |                   0.885814 |     0.069 | 4.50257e-6 |

### Polus (мастер-рабочий)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       3.0e-5 |                   2 |                   0.003467 |         1 | 1.66131e-5 |
|       3.0e-5 |                   4 |                   0.005969 |     0.581 | 1.78859e-5 |
|       3.0e-5 |                  16 |                   0.009107 |     0.381 | 1.61746e-5 |
|       3.0e-5 |                  64 |                   0.009415 |     0.368 | 1.68098e-5 |
|       5.0e-6 |                   2 |                   0.012143 |         1 | 2.72662e-6 |
|       5.0e-6 |                   4 |                   0.018976 |     0.640 | 2.86175e-6 |
|       5.0e-6 |                  16 |                   0.104414 |     0.116 | 3.09910e-6 |
|       5.0e-6 |                  64 |                   0.179996 |     0.067 | 3.33829e-6 |
|       1.5e-6 |                   2 |                   0.036833 |         1 | 8.72001e-7 |
|       1.5e-6 |                   4 |                   0.099202 |     0.371 | 9.59019e-7 |
|       1.5e-6 |                  16 |                   0.546503 |     0.067 | 8.12681e-7 |
|       1.5e-6 |                  64 |                   1.198120 |     0.031 | 9.51823e-7 |

### Bluegene (обычная схема)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       1.0e-4 |                   1 |                   0.008306 |         1 | 6.30016e-5 |
|       1.0e-4 |                   4 |                   0.003357 |     2.474 | 6.06925e-5 |
|       1.0e-4 |                  16 |                   0.001221 |     6.802 | 6.65863e-5 |
|       1.0e-4 |                  64 |                   0.000495 |    16.773 | 6.09067e-5 |
|       2.0e-5 |                   1 |                   0.068640 |         1 | 1.07895e-5 |
|       2.0e-5 |                   4 |                   0.019161 |     3.582 | 1.24707e-5 |
|       2.0e-5 |                  16 |                   0.005643 |    12.163 | 1.10576e-5 |
|       2.0e-5 |                  64 |                   0.005120 |    13.405 | 1.14240e-5 |
|       8.0e-6 |                   1 |                   0.266687 |         1 | 4.66384e-6 |
|       8.0e-6 |                   4 |                   0.197808 |     1.348 | 4.33287e-6 |
|       8.0e-6 |                  16 |                   0.018829 |    14.164 | 4.86004e-6 |
|       8.0e-6 |                  64 |                   0.022238 |    11.992 | 5.06120e-6 |

### Polus (обычная схема)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       3.0e-5 |                   1 |                   0.002221 |         1 | 1.77963e-5 |
|       3.0e-5 |                   4 |                   0.003111 |     0.714 | 1.74121e-5 |
|       3.0e-5 |                  16 |                   0.001862 |     1.193 | 1.90208e-5 |
|       3.0e-5 |                  64 |                   0.001934 |     1.148 | 1.85604e-5 |
|       5.0e-6 |                   1 |                   0.041514 |         1 | 2.74958e-6 |
|       5.0e-6 |                   4 |                   0.038329 |     1.083 | 2.85969e-6 |
|       5.0e-6 |                  16 |                   0.006168 |     6.731 | 3.27807e-6 |
|       5.0e-6 |                  64 |                   0.011487 |     3.614 | 2.91695e-6 |
|       1.5e-6 |                   1 |                   0.093323 |         1 | 9.05425e-7 |
|       1.5e-6 |                   4 |                   0.578205 |     0.161 | 8.01429e-7 |
|       1.5e-6 |                  16 |                   0.026702 |     3.495 | 9.07634e-7 |
|       1.5e-6 |                  64 |                   0.027527 |     3.390 | 9.51205e-7 |

## Результаты расчётов на различных кластерах (N = 1000)

### Bluegene (мастер-рабочий)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       1.0e-4 |                   2 |                   0.025181 |         1 | 5.94907e-5 |
|       1.0e-4 |                   4 |                   0.026026 |     0.968 | 5.12393e-5 |
|       1.0e-4 |                  16 |                   0.040886 |     0.616 | 5.37999e-5 |
|       1.0e-4 |                  64 |                   0.078336 |     0.321 | 5.72646e-5 |
|       2.0e-5 |                   2 |                   0.184750 |         1 | 1.24655e-5 |
|       2.0e-5 |                   4 |                   0.366492 |     0.504 | 1.20767e-5 |
|       2.0e-5 |                  16 |                   0.146726 |     1.259 | 1.12072e-5 |
|       2.0e-5 |                  64 |                   0.501224 |     0.369 | 1.18898e-5 |
|       8.0e-6 |                   2 |                   0.223830 |         1 | 4.46804e-6 |
|       8.0e-6 |                   4 |                   0.882050 |     0.254 | 4.47101e-6 |
|       8.0e-6 |                  16 |                   0.948025 |     0.236 | 4.83199e-6 |
|       8.0e-6 |                  64 |                   1.907600 |     0.117 | 4.72291e-6 |

### Polus (мастер-рабочий)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       3.0e-5 |                   2 |                   0.015593 |         1 | 1.82846e-5 |
|       3.0e-5 |                   4 |                   0.010612 |     1.469 | 1.76684e-5 |
|       3.0e-5 |                  16 |                   0.016800 |     0.928 | 1.73457e-5 |
|       3.0e-5 |                  64 |                   0.028649 |     0.544 | 1.64332e-5 |
|       5.0e-6 |                   2 |                   0.050164 |         1 | 2.55487e-6 |
|       5.0e-6 |                   4 |                   0.180100 |     0.279 | 3.14434e-6 |
|       5.0e-6 |                  16 |                   0.167635 |     0.299 | 2.83515e-6 |
|       5.0e-6 |                  64 |                   0.321604 |     0.156 | 2.73644e-6 |
|       1.5e-6 |                   2 |                   0.104539 |         1 | 9.34065e-7 |
|       1.5e-6 |                   4 |                   0.691521 |     0.151 | 7.40848e-7 |
|       1.5e-6 |                  16 |                   1.413300 |     0.074 | 9.69010e-7 |
|       1.5e-6 |                  64 |                   1.487260 |     0.070 | 7.99376e-7 |

### Bluegene (обычная схема)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       1.0e-4 |                   1 |                   0.013379 |         1 | 5.62939e-5 |
|       1.0e-4 |                   4 |                   0.006366 |     2.102 | 5.82478e-5 |
|       1.0e-4 |                  16 |                   0.002602 |     5.142 | 5.84753e-5 |
|       1.0e-4 |                  64 |                   0.001724 |     7.761 | 5.51759e-5 |
|       2.0e-5 |                   1 |                   0.117656 |         1 | 1.18561e-5 |
|       2.0e-5 |                   4 |                   0.048859 |     2.408 | 1.15702e-5 |
|       2.0e-5 |                  16 |                   0.011829 |     9.946 | 1.16796e-5 |
|       2.0e-5 |                  64 |                   0.009591 |    12.267 | 1.17729e-5 |
|       8.0e-6 |                   1 |                   0.353842 |         1 | 4.39475e-6 |
|       8.0e-6 |                   4 |                   0.446547 |     0.792 | 5.23333e-6 |
|       8.0e-6 |                  16 |                   0.054526 |     6.489 | 4.63279e-6 |
|       8.0e-6 |                  64 |                   0.035991 |     9.831 | 5.20942e-6 |

### Polus (обычная схема)

| Точность (ε) | Число MPI процессов | Время работы программы (с) | Ускорение |   Ошибка   |
|          :-: |                 :-: |                        :-: |       :-: |        :-: |
|       3.0e-5 |                   1 |                   0.007260 |         1 | 1.83298e-5 |
|       3.0e-5 |                   4 |                   0.004095 |     1.773 | 1.94462e-5 |
|       3.0e-5 |                  16 |                   0.002164 |     3.354 | 1.61581e-5 |
|       3.0e-5 |                  64 |                   0.002582 |     2.812 | 1.81731e-5 |
|       5.0e-6 |                   1 |                   0.072420 |         1 | 2.53375e-6 |
|       5.0e-6 |                   4 |                   0.035764 |     2.025 | 2.57642e-6 |
|       5.0e-6 |                  16 |                   0.014840 |     4.880 | 2.84998e-6 |
|       5.0e-6 |                  64 |                   0.013700 |     5.286 | 3.15469e-6 |
|       1.5e-6 |                   1 |                   0.768074 |         1 | 7.92767e-7 |
|       1.5e-6 |                   4 |                   0.424769 |     1.808 | 7.19423e-7 |
|       1.5e-6 |                  16 |                   0.053645 |    14.318 | 9.54345e-7 |
|       1.5e-6 |                  64 |                   0.061933 |    12.402 | 9.14685e-7 |